# RDC - 远程桌面客户端

基于 Windows mstsc 库（ActiveX）实现的远程桌面客户端示例程序。

## 功能特性

### 已实现
- ✅ 基本的 QML 界面
- ✅ 菜单栏（连接、帮助）
- ✅ 连接配置对话框
  - 连接设置
    - IP地址/主机名输入
    - 端口配置（默认3389）
    - 用户名输入
  - 显示设置
    - 自定义分辨率（默认 1920x1080）
    - 色彩深度选择（15/16/24/32位）
    - 全屏模式开关
  - 本地资源
    - 远程音频重定向
    - 剪贴板共享
    - 打印机重定向
- ✅ RDP 客户端封装（RdpClient 类）
  - 基于 MsTscAx ActiveX 控件
  - 支持 IMsRdpClient10/9 接口
  - 可配置参数：
    - 服务器地址和端口
    - 用户名
    - 分辨率和色彩深度
    - 全屏模式
    - 音频、剪贴板、打印机重定向
- ✅ 连接状态显示
- ✅ 错误处理和提示

## 使用方法

1. 启动程序
2. 点击菜单 [连接] -> [启动]
3. 在弹出的对话框中配置：
   
   **连接设置：**
   - 计算机：远程主机的IP地址或主机名
   - 端口：RDP端口（默认3389）
   - 用户名：登录用户名
   
   **显示设置：**
   - 分辨率：自定义宽度和高度（如 1920x1080）
   - 色彩深度：选择 15/16/24/32 位
   - 全屏显示：勾选后以全屏模式连接
   
   **本地资源：**
   - 远程音频：启用远程计算机的声音播放
   - 剪贴板：启用本地和远程之间的复制粘贴
   - 打印机：重定向本地打印机到远程会话

4. 点击 OK 发起连接

## 技术架构

- **Qt 5.15.2** - 应用框架
- **QML** - 用户界面
- **Qt ActiveX** - COM/ActiveX 支持
- **MsTscAx** - Windows 远程桌面控件

## 项目结构

```
RDC/
├── main.cpp              # 程序入口
├── main.qml              # 主窗口界面
├── ConnectionDialog.qml  # 连接配置对话框
├── RdpClient.h          # RDP客户端头文件
├── RdpClient.cpp        # RDP客户端实现
├── qml.qrc              # QML资源文件
└── RDC.vcxproj          # Visual Studio项目文件
```

## 下一步计划

- [ ] 密码输入支持
- [ ] RDP会话窗口显示
- [ ] 断开连接功能
- [ ] 连接历史记录
- [ ] 高级设置（音频、剪贴板、驱动器映射等）
- [ ] 多会话管理
